---
import { Icon } from 'astro-icon/components'
import { Image } from 'astro:assets'
import logo from '@/assets/logo-dark.png'
import { link } from '@/utils/links'
const copyrightYear = new Date().getFullYear()
---

<footer>
  <div class="container">
    <div class="grid">
      <div>
        <div class="brand">
          <Image src={logo} alt="WWM Tools Logo" class="logo-img" width={24} height={24} />
          <h1>WWM Tools</h1>
        </div>
        <p>
          A curated archive of self-written tools, guides, and structured references for planning
          routes, builds, and progression in <i>Where Winds Meet</i>.
        </p>
      </div>

      <div>
        <h4>Resources</h4>
        <ul>
          <li><a href={link('compendium')}>Compendium</a></li>
          <li><a href={link('guides')}>Guides</a></li>
          <li><a href={link('tools')}>Tools</a></li>
          <li><a href={link('about')}>About</a></li>
        </ul>
      </div>

      <div>
        <h4>Support / Contact</h4>

        <p class="support-text">
          If the tools helped you, you can leave a like on my profile in-game.
        </p>

        <div class="contact-list">
          <button
            class="contact-item"
            data-copy="2074816091"
            aria-label="Copy Character ID to clipboard"
          >
            <Icon name="fa6-solid:copy" size={24} />
            <span class="tooltip">Character ID<br /><b>2074816091</b></span>
          </button>

          <button class="contact-item muted">
            <Icon name="fa6-brands:discord" size={24} />
            <span>Discord pending</span>
          </button>
        </div>
      </div>
    </div>

    <div class="bottom">
      <p class="copyright">
        Â© {copyrightYear} WWM Tools. Independent fan project.
      </p>
    </div>
  </div>
</footer>

<script>
  for (const element of document.querySelectorAll<HTMLElement>('[data-copy]')) {
    let resetTimer: ReturnType<typeof setTimeout> | undefined
    element.addEventListener('click', () => {
      const value = element.dataset.copy
      if (!value) return

      navigator.clipboard.writeText(value)

      const tooltip = element.querySelector('.tooltip')
      if (!tooltip) return

      const originalText = tooltip.innerHTML
      tooltip.innerHTML = '<b>Copied</b>'

      if (resetTimer) clearTimeout(resetTimer)

      resetTimer = setTimeout(() => {
        tooltip.innerHTML = originalText
      }, 1200)
    })
  }
</script>

<style lang="scss">
  @use '../scss/mixins' as *;

  footer {
    @include border($top: true);
    padding: 3.3rem 5rem;
    @include background(surface-1, $opacity: 0.5);
    flex: 0 0 auto;
  }

  .container {
    max-width: 1440px;
    margin: 0 auto;
  }

  .grid {
    display: grid;
    grid-template-columns: 1.2fr 0.8fr 1fr;
    gap: 3rem;

    & > div {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }
  }

  .brand {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;

    h1 {
      @include text-color(primary);
      @include increase-letter-spacing;
    }
  }

  .logo-img {
    width: 1.5rem;
    height: auto;
    object-fit: contain;
  }

  p {
    @include text-color(muted);
    @include font-size(sm);
    max-width: 300px;
  }

  h4 {
    @include increase-letter-spacing(3);
    margin-bottom: 1.2rem;
    @include text-color(default);
  }

  ul {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    list-style: none;
    padding: 0;
    margin: 0;

    a {
      @include font-size(sm);
      @include text-color(muted);
      @include hover-transition($color: get-text-color(primary), $duration: short);
      text-decoration: none;
    }
  }

  .socials {
    display: flex;
    gap: 1rem;

    a {
      width: 2.5rem;
      height: 2.5rem;
      @include border;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      @include text-color(muted);
      @include hover-transition(
        $color: get-text-color(primary),
        $border-color: get-border-color(primary),
        $duration: short
      );
    }
  }

  .contact-item {
    margin-top: 0.75rem;
    padding: 1rem 1.2rem;
    width: 100%;
    max-width: 280px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-align: left;

    @include font-sans-regular;
    @include border;
    @include background(surface-2, $opacity: 0.5);
    @include hover-transition($border-color: get-border-color(primary));

    &:first-child {
      min-height: 4.75rem;
    }

    &.muted {
      @include text-color(muted);
      @include hover-transition($border-color: get-border-color(outline));
      cursor: default;
    }
  }

  .bottom {
    max-width: 1440px;
    margin: 0 auto;
    margin-top: 3rem;
    padding-top: 1.5rem;
    @include border($top: true);
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    gap: 1.5rem;
  }

  .copyright {
    @include increase-letter-spacing;
    @include font-sans-bold;
    opacity: 0.8;
    max-width: none;
  }
</style>
